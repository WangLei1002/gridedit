(function(){var t,e=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};t=function(){function t(e,i){var o,r,s,n;if(this.config=e,this.actionStack=i,this.dirtyCells=[],this.dirtyRows=[],this.copiedGridChange=this.config.copiedGridChange,this.uniqueValueKey=this.config.uniqueValueKey,this.rowIndex=this.config.rowIndex,this.useFixedHeaders=this.config.useFixedHeaders,this.element=document.querySelectorAll(this.config.element||"#gridedit")[0],this.contextMenu=new t.ContextMenu(this),this.themeName=this.config.themeName,this.customTheme=this.config.themeTemplate,this.theme=new t.Theme(this.themeName,this.customTheme),this.draggingRow=null,this.lastDragOver=null,this.lastDragOverIsBeforeFirstRow=!1,this.lastClickCell=null,this.headers=[],this.rows=[],this.subtotalRows=[],this.cols=[],this.source=this.config.rows,this.redCells=[],this.activeCells=[],this.copiedCells=null,this.selectionStart=null,this.selectionEnd=null,this.selectedCol=null,this.openCell=null,this.state="ready",this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.topOffset=this.config.topOffset?this.config.topOffset:0,this.config.custom){s=this.config.custom;for(r in s)n=s[r],r in this.config.custom&&this.set(r,n);delete this.config.custom}this.config.initialize&&this.init(),this.actionStack||(this.actionStack=new t.ActionStack(this)),this.config.selectedCell&&((o=this.getCell(this.config.selectedCell[0],this.config.selectedCell[1]))&&o.makeActive(),this.config.selectedCell=void 0)}return t.prototype.init=function(){this.config.beforeInit&&this.config.beforeInit(),t.Hook.prototype.initTableHooks(this),this.build(),this.events(),this.render(),this.removeBrowserHighlighting(),this.rowIndex||this.setRowIndexes(),this.config.afterInit&&this.config.afterInit()},t.prototype.setRowIndexes=function(){var t,e,i,o,r,s,n;if(!this.config.uniqueValueKey)return!1;for(s={},n=this.config.uniqueValueKey,t=e=0,i=(o=this.source).length;e<i;t=++e)r=o[t],s[t]=r[n];return this.rowIndex=s},t.prototype.removeBrowserHighlighting=function(){var t,e,i,o,r;for(i=[],t=0,e=(r=["-webkit-touch-callout","-webkit-user-select","-khtml-user-select","-moz-user-select","-ms-user-select","user-select"]).length;t<e;t++)o=r[t],i.push(this.tableEl.style[o]="none");return i},t.prototype.build=function(){var e,i,o,r,s,n,l,a,h,c,d,u,p,f,y,b;for(b=document.createElement("tr"),this.config.includeRowHandles&&(r=document.createElement("th"),b.appendChild(r)),s=n=0,a=(c=this.config.cols).length;n<a;s=++n)i=c[s],e=new t.Column(i,this),this.cols.push(e),e.element&&b.appendChild(e.element);for(this.thead=document.createElement("thead"),o=this,this.thead.ondragenter=function(){var t;if(o.lastDragOverIsBeforeFirstRow=!0,t=o.lastDragOver)return t.element.style.borderBottom=t.oldBorderBottom,t.element.style.borderTop=o.theme.borders.dragBorderStyle},this.thead.ondragleave=function(){var t;return t=o.rows[0],t.element.style.borderTop=t.oldBorderTop},this.thead.appendChild(b),y=document.createElement("tbody"),s=l=0,h=(d=this.source).length;l<h;s=++l){switch((p=d[s]).gridEditRowType){case"static":u=new t.StaticRow(p,this);break;case"subtotal":u=new t.SubTotalRow(p,this);break;case"heading":u=new t.HeaderRow(p,this);break;case"custom":u=new t[p.customClassName||"GenericRow"](p,this);break;default:u=new t.GenericRow(p,this)}this.rows.push(u),y.appendChild(u.element)}if(f=document.createElement("table"),t.Utilities.prototype.setAttributes(f,{id:"editable-grid",class:this.config.tableClass}),f.appendChild(this.thead),f.appendChild(y),this.tableEl=f,this.useFixedHeaders)return this.element.style.overflowY="scroll",t.Utilities.prototype.fixHeaders(this),window.addEventListener("resize",function(){return t.Utilities.prototype.fixHeaders(o)})},t.prototype.rebuild=function(t){var e,i,o;if(null==t&&(t=null),this.contextMenu.hide(),i=Object.create(this.config),i.rowIndex=this.rowIndex,null!==t)for(o in t)t[o],i[o]=t[o];return i.copiedGridChange=this.copiedGridChange,e=this.actionStack,this.destroy(),this.constructor(i,e)},t.prototype.hideControl=function(){if(this.openCell)return this.openCell.edit(this.openCell.control.value)},t.prototype.events=function(){var i;return i=this,document.onkeydown=function(t){var o,r,s,n;if(i.activeCell())if(s=t.keyCode,n=t.shiftKey,r=t.ctrlKey,t.metaKey||r){if(s&&91!==s&&92!==s&&(o=i.contextMenu.actionCallbacks.byControl[s]))return t.preventDefault(),i.contextMenu.execute(o,t)}else switch(s){case 8:i.openCell||(t.preventDefault(),i.delete());break;case 9:return t.preventDefault(),n?i.moveTo(i.previousCell()):i.moveTo(i.nextCell());case 13:i.activeCell().onReturnKeyPress();break;case 16:break;case 32:i.openCell||(t.preventDefault(),i.activeCell().onSpaceKeyPress());break;case 37:i.moveTo(i.previousCell());break;case 38:i.moveTo(i.aboveCell());break;case 39:i.activeCell().isBeingEdited()||i.moveTo(i.nextCell());break;case 40:i.moveTo(i.belowCell());break;case 46:if(!i.openCell){t.preventDefault(),i.delete();break}break;default:return e.call([96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111],s)>=0&&(s-=48),i.openCellAndPopulateInitialValue(n,s)}},window.onresize=function(){if(i.openCell)return t.Utilities.prototype.setStyles(i.openCell.control,i.openCell.position())},window.onscroll=function(){if(i.openCell)return i.openCell.reposition()},this.element.onscroll=function(e){if(i.openCell&&i.openCell.reposition(),i.useFixedHeaders)return t.Utilities.prototype.repositionFixedHeader(i)},this.tableEl.oncontextmenu=function(t){return!1},document.oncontextmenu=function(t){return i.contextMenu.element!==t.target},document.onclick=function(e){var o;return o=i.firstActiveCell(),i.isDescendant(e.target||i.contextMenu.isVisible())||e.target!==(null!=o?o.control:void 0)&&((null!=o?o.isBeingEdited():void 0)&&null!=o&&o.edit(null!=o?o.control.value:void 0),t.Utilities.prototype.clearActiveCells(i)),i.contextMenu.hide()}},t.prototype.render=function(){return this.element.hasChildNodes()&&(this.element=document.querySelectorAll(this.config.element||"#gridedit")[0]),this.element.appendChild(this.tableEl)},t.prototype.getCell=function(t,e){try{return this.rows[t].cells[e]}catch(t){t}},t.prototype.set=function(t,e){if(void 0!==t)return this.config[t]=e},t.prototype.activeCell=function(){return this.activeCells.length>1?this.activeCells:this.activeCells[0]},t.prototype.firstActiveCell=function(){return this.activeCells[0]},t.prototype.nextCell=function(){var t;return null!=(t=this.firstActiveCell())?t.next():void 0},t.prototype.previousCell=function(){var t;return null!=(t=this.firstActiveCell())?t.previous():void 0},t.prototype.aboveCell=function(){var t;return null!=(t=this.firstActiveCell())?t.above():void 0},t.prototype.belowCell=function(){var t;return null!=(t=this.firstActiveCell())?t.below():void 0},t.prototype.moveTo=function(t,e){var i,o,r,s;return t&&(void 0===e&&(e=t.table.firstActiveCell()),o=t.table.getDirection(e,t),t.beforeNavigateTo&&(i=t.beforeNavigateTo(t,e,o)),!1!==i&&(t.isVisible()||(s=t.table.activeCell().address[0],r=1,t.address[0]<s&&(r=-1),window.scrollBy(0,(null!=t?t.position().height:void 0)*r)),t.makeActive())),!1},t.prototype.getDirection=function(t,e){var i,o,r,s,n;return r=t.address[0],n=e.address[0],o=t.address[1],s=e.address[1],r===n?o>s?i="left":o<s?i="right":console.log("Cannot calculate direction going from cell "+t.address+" to cell "+e.address):r>n?i="up":r<n?i="down":console.log("Cannot calculate direction going from cell "+t.address+" to cell "+e.address),i},t.prototype.edit=function(t,e){return null==e&&(e=null),null!==e?null!=t?t.cellTypeObject.edit(e):void 0:(t.cellTypeObject.edit(),!1)},t.prototype.delete=function(){var t,e,i,o;for(e=0,i=(o=this.activeCells).length;e<i;e++)(t=o[e]).editable&&t.value("");return!0},t.prototype.clearActiveCells=function(){return t.Utilities.prototype.clearActiveCells(this)},t.prototype.setSelection=function(){var t,e,i,o,r,s,n,l,a,h,c,d,u,p,f;if(this.selectionStart&&this.selectionEnd&&this.selectionStart!==this.selectionEnd){for(i=0,o=(a=this.activeCells).length;i<o;i++)a[i].showInactive();for(this.activeCells=[],f=function(){d=[];for(var t=h=this.selectionStart.address[0],e=this.selectionEnd.address[0];h<=e?t<=e:t>=e;h<=e?t++:t--)d.push(t);return d}.apply(this),e=function(){u=[];for(var t=c=this.selectionStart.address[1],e=this.selectionEnd.address[1];c<=e?t<=e:t>=e;c<=e?t++:t--)u.push(t);return u}.apply(this),n=0,r=f.length;n<r;n++)for(p=f[n],l=0,s=e.length;l<s;l++)t=e[l],this.rows[p].cells[t].addToSelection()}},t.prototype.data=function(){var t,e,i,o,r,s,n,l,a;for(e=[],i=0,r=(n=this.rows).length;i<r;i++){for(a=[],o=0,s=(l=n[i].cells).length;o<s;o++)t=l[o],a.push(t.cellTypeObject.value());e.push(a)}return e},t.prototype.repopulate=function(){var t,e,i,o,r,s;for(r=[],e=0,i=(o=this.rows).length;e<i;e++)s=o[e],r.push(function(){var e,i,o,r;for(r=[],e=0,i=(o=s.cells).length;e<i;e++)t=o[e],r.push(t.value(t.source[t.valueKey]));return r}());return r},t.prototype.destroy=function(){var t,e;this.useFixedHeaders&&this.fixedHeader&&this.fixedHeader.table&&this.fixedHeader.table.parentNode&&document.body.removeChild(this.fixedHeader.table),this.element.removeChild(this.tableEl),e=[];for(t in this)e.push(delete this[t]);return e},t.prototype.isDescendant=function(t){var e;for(e=t.parentNode;null!=e;){if(e===this.tableEl)return!0;e=e.parentNode}return!1},t.prototype.addToStack=function(t){return this.actionStack.addAction(t)},t.prototype.undo=function(){return this.actionStack.undo()},t.prototype.redo=function(){return this.actionStack.redo()},t.prototype.moveRow=function(e,i,o){var r;if(null==o&&(o=!0),r=this.source[e],t.Hook.prototype.run(this,"beforeMoveRow",e,i))return this.source.splice(e,1),this.source.splice(i,0,r),o&&this.addToStack({type:"move-row",oldIndex:e,newIndex:i}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[i,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterMoveRow",e,i)},t.prototype.moveRows=function(e,i,o,r){var s,n,l,a,h;if(null==r&&(r=!0),t.Hook.prototype.run(this,"beforeMoveRows",e,i)){if(n=e,l=i,s=e+o,i>e){if(i<s)return void this.clearActiveCells();i=i-o+1}else n=e+o-1;for(a=(h=this.source.splice(e,o)).pop();a;)this.source.splice(i,0,a),a=h.pop();return r&&this.addToStack({type:"move-rows",modifiedRowToMoveIndex:n,modifiedNewIndex:i,numRows:o,originalRowToMoveIndex:e,originalNewIndex:l}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[i,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterMoveRows",e,i,o)}},t.prototype.addRow=function(e,i,o){var r,s,n,l,a;if(null==i&&(i=!0),null==o&&(o=!1),t.Hook.prototype.run(this,"beforeAddRow",e,o)){if(o)a=o;else for(a={},s=0,n=(l=this.cols).length;s<n;s++)a[(r=l[s]).valueKey]=r.defaultValue||"";return e||0===e?this.source.splice(e,0,a):(e=this.source.length-1,this.source.push(a)),i&&this.addToStack({type:"add-row",index:e,rowObject:o}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[e,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterAddRow",e,o)}},t.prototype.addRows=function(e,i,o){var r,s,n,l,a,h,c,d,u,p;if(null==i&&(i=!0),null==o&&(o=[]),t.Hook.prototype.run(this,"beforeAddRows",e,o)){for(s=n=0,a=o.length;n<a;s=++n){if(p=o[s],c=e+s,p)u=p;else for(u={},l=0,h=(d=this.cols).length;l<h;l++)u[(r=d[l]).valueKey]=r.defaultValue||"";c||0===c?this.source.splice(c,0,u):(c=this.source.length-1,this.source.push(u))}return i&&this.addToStack({type:"add-rows",index:e,rowObjects:o}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[e,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterAddRows",e,o)}},t.prototype.addScatteredRows=function(t){var e,i,o,r,s;for(i=0,o=(r=(r=Object.keys(t)).sort()).length;i<o;i++)s=t[e=r[i]],this.source.splice(e,0,s);return this.rebuild({rows:this.source,initialize:!0,selectedCell:[e,0]}),this.setDirtyRows()},t.prototype.insertBelow=function(){var e;if(e=this.contextMenu.getUpperLeftPasteCell(),t.Hook.prototype.run(this,"beforeInsertBelow",e))return this.addRow(e.address[0]+1),this.setDirtyRows(),t.Hook.prototype.run(this,"afterInsertBelow",e)},t.prototype.insertAbove=function(){var e;if(e=this.contextMenu.getUpperLeftPasteCell(),t.Hook.prototype.run(this,"beforeInsertAbove",e))return this.addRow(e.address[0]),this.setDirtyRows(),t.Hook.prototype.run(this,"afterInsertAbove",e)},t.prototype.removeRow=function(e,i){var o;if(null==i&&(i=!0),t.Hook.prototype.run(this,"beforeRemoveRow",e))return o=this.source[e],this.rows[e],this.source.splice(e,1),i&&this.addToStack({type:"remove-row",index:e,rowObject:o}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[e,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterRemoveRow",e)},t.prototype.removeRows=function(e,i){var o,r,s,n,l;if(null==i&&(i=!0),t.Hook.prototype.run(this,"beforeRemoveRows",e)){for(l={},r=0,s=(e=e.sort(function(t,e){return e-t})).length;r<s;r++)o=e[r],n=this.source[o],l[o]=n,this.source.splice(o,1);return i&&this.addToStack({type:"remove-rows",rowIndexes:e,rowObjects:l}),this.rebuild({rows:this.source,initialize:!0,selectedCell:[o,0]}),this.setDirtyRows(),t.Hook.prototype.run(this,"afterRemoveRows",e)}},t.prototype.selectRow=function(e,i){var o,r,s,n,l,a,h,c,d,u,p,f,y;if(this.activeCell()&&e){if(s=this.activeCells[0].address[0],y=e.shiftKey,r=e.ctrlKey,o=e.metaKey,r||o||t.Utilities.prototype.clearActiveCells(this),y){if(s-i<0){for(u=[],n=0,a=(c=this.rows.slice(s,+i+1||9e9)).length;n<a;n++)f=c[n],u.push(f.select());return u}for(p=[],l=0,h=(d=this.rows.slice(i,+s+1||9e9)).length;l<h;l++)f=d[l],p.push(f.select());return p}return(f=this.rows[i]).select()}return(f=this.rows[i]).select()},t.prototype.calculateSubtotals=function(){var t,e,i,o,r;for(o=[],t=0,e=(i=this.subtotalRows).length;t<e;t++)r=i[t],o.push(r.calculate());return o},t.prototype.openCellAndPopulateInitialValue=function(e,i){if(!this.openCell)return this.activeCell().onKeyPress(t.Utilities.prototype.valueFromKey(i,e))},t.prototype.checkIfCellIsDirty=function(t){var e;if(-1===(e=this.dirtyCells.indexOf(t))){if(t.isDirty())return this.dirtyCells.push(t)}else if(!t.isDirty())return this.dirtyCells.splice(e,1)},t.prototype.setDirtyRows=function(){var t,e,i,o;if(!this.config.uniqueValueKey)return!1;this.dirtyRows=[],o=this.uniqueValueKey,t=this.rowIndex,e=[];for(i in t)t[i]!==this.source[i][o]?e.push(this.dirtyRows.push(i)):e.push(void 0);return e},t.prototype.isDirty=function(){return this.dirtyRows.length>0||this.dirtyCells.length>0},t.prototype.addUndoAction=function(t,e){return this.actionStack.addUndo(t,e)},t.prototype.addRedoAction=function(t,e){return this.actionStack.addRedo(t,e)},t}(),("undefined"!=typeof exports&&null!==exports?exports:window).GridEdit=t}).call(this),function(){GridEdit.ActionStack=function(){function t(t){this.table=t,this.userDefinedActions={undo:{},redo:{}},this.index=-1,this.actions=[]}return t.prototype.getCell=function(t){return this.table.getCell(t.address[0],t.address[1])},t.prototype.addAction=function(t){return this.actions.length>0&&this.index<this.actions.length-1&&(this.actions=this.actions.splice(0,this.index+1)),this.actions.push(t),this.index++},t.prototype.addUndo=function(t,e){return this.userDefinedActions.undo[t]=e},t.prototype.addRedo=function(t,e){return this.userDefinedActions.redo[t]=e},t.prototype.undo=function(){var t,e,i,o,r;if(this.index>-1)switch(this.index--,(t=this.actions[this.index+1]).type){case"cell-edit":this.getCell(t).value(t.oldValue,!1);break;case"cut":t.grid.undo(!1,!1);break;case"paste-pasteGrid":t.pasteGrid.undo(t.x,t.y);break;case"paste-copyGrid":t.grid.undo(t.x,t.y);break;case"fill":t.grid.undo(!1,!1);break;case"add-row":this.table.removeRow(t.index,!1);break;case"remove-row":this.table.addRow(t.index,!1,t.rowObject);break;case"move-row":this.table.moveRow(t.newIndex,t.oldIndex,!1);break;case"add-rows":for(r=[],e=i=0,o=t.rowObjects.length;0<=o?i<o:i>o;e=0<=o?++i:--i)r.push(e+t.index);this.table.removeRows(r,!1);break;case"remove-rows":this.table.addScatteredRows(t.rowObjects);break;case"move-rows":this.table.moveRows(t.modifiedNewIndex,t.modifiedRowToMoveIndex,t.numRows,!1);break;default:return this.userDefinedActions.undo[t.type](t)}},t.prototype.redo=function(){var t;if(this.index<this.actions.length-1)switch(this.index++,(t=this.actions[this.index]).type){case"cell-edit":this.table.getCell(t.address[0],t.address[1]).value(t.newValue,!1);break;case"cut":t.grid.apply(!1,!1);break;case"paste-pasteGrid":t.grid.applyTo(t.pasteGrid);break;case"paste-copyGrid":t.grid.apply(t.x,t.y);break;case"fill":t.grid.apply(!1,!1);break;case"add-row":this.table.addRow(t.index,!1,t.rowObject);break;case"remove-row":this.table.removeRow(t.index,!1);break;case"move-row":this.table.moveRow(t.oldIndex,t.newIndex,!1);break;case"add-rows":this.table.addRows(t.index,!1,t.rowObjects);break;case"remove-rows":this.table.removeRows(t.rowIndexes,!1);break;case"move-rows":this.table.moveRows(t.originalRowToMoveIndex,t.originalNewIndex,t.numRows,!1);break;default:return this.userDefinedActions.redo[t.type](t)}},t}()}.call(this),function(){GridEdit.ContextMenu=function(){function t(t){var e,i,o,r,s,n,l,a;if(this.table=t,this.active=!1!==this.table.config.includeContextMenu,this.userDefinedActions=this.table.config.contextMenuItems,this.userDefinedOrder=this.table.config.contextMenuOrder,o=/Mac/.test(navigator.platform)?"Cmd":"Ctrl",this.actionNodes={},this.actionCallbacks={byName:{},byControl:{}},this.borderedCells=[],this.defaultActions={cut:{name:"Cut",shortCut:o+"+X",callback:this.cut},copy:{name:"Copy",shortCut:o+"+C",callback:this.copy},paste:{name:"Paste",shortCut:o+"+V",callback:this.paste},undo:{name:"Undo",shortCut:o+"+Z",callback:this.undo},redo:{name:"Redo",shortCut:o+"+Y",callback:this.redo},fill:{name:"Fill",shortCut:"",hasDivider:!0,callback:this.fill},selectAll:{name:"Select All",shortCut:o+"+A",callback:this.selectAll},insertBelow:{name:"Insert Row Below",shortCut:"",callback:this.insertBelow},insertAbove:{name:"Insert Row Above",shortCut:"",callback:this.insertAbove},removeRow:{name:"Remove Row(s)",shortCut:"",callback:this.removeRow}},this.element=document.createElement("div"),this.element.id="gridedit-context-menu",this.element.style.position="fixed",this.element.style.zIndex="1040",this.menu=document.createElement("ul"),GridEdit.Utilities.prototype.setAttributes(this.menu,{class:"dropdown-menu",role:"menu","aria-labelledby":"aria-labelledby",style:"display:block;position:static;margin-bottom:5px;"}),this.active)if(this.userDefinedOrder)for(r=0,s=(n=this.userDefinedOrder).length;r<s;r++)i=n[r],(e=this.userDefinedActions?this.userDefinedActions[i]||this.defaultActions[i]:this.defaultActions[i])&&this.addAction(e);else{l=this.defaultActions;for(i in l)e=l[i],this.userDefinedActions&&(this.userDefinedActions[i]||!1===this.userDefinedActions[i])||this.addAction(e);a=this.userDefinedActions;for(i in a)e=a[i],!1!==this.userDefinedActions[i]&&this.addAction(e)}this.element.appendChild(this.menu),this.events(this),GridEdit.Hook.prototype.initContextMenuHooks(this)}return t.prototype.addDivider=function(){var t;return t=document.createElement("li"),GridEdit.Utilities.prototype.setAttributes(t,{class:"divider"}),this.menu.appendChild(t)},t.prototype.addAction=function(t){var e,i,o,r,s;return(o=document.createElement("li")).setAttribute("name",t.name),document.createElement("div"),s=document.createElement("span"),s.textContent=t.shortCut,GridEdit.Utilities.prototype.setAttributes(s,{style:"float: right !important;"}),e=document.createElement("a"),e.textContent=t.name,e.setAttribute("name",t.name),GridEdit.Utilities.prototype.setAttributes(e,{class:"enabled",tabIndex:"-1"}),t.hasDivider&&this.addDivider(),e.appendChild(s),o.appendChild(e),this.actionNodes[t.name]=o,this.actionCallbacks.byName[t.name]=t.callback,(r=t.shortCut)&&/(ctrl|cmd)/i.test(r)&&(i=r.split("+")[1].charCodeAt(0),this.actionCallbacks.byControl[i]=t.callback),this.menu.appendChild(o)},t.prototype.show=function(t,e,i){var o;if(this.cell=i,this.active)return this.cell.isActive()||this.cell.makeActive(),this.cells=this.cell.table.activeCells,GridEdit.Utilities.prototype.setStyles(this.element,{left:t,top:e}),document.body.appendChild(this.element),o=this.element,setTimeout(function(){var t,e,i,r,s,n,l,a,h,c,d,u;return h=o.getBoundingClientRect(),d=GridEdit.Utilities.prototype.getScreenDimensions(),l=d.height>h.height,e=h.bottom>d.height,s=h.top<0,n=d.width>h.width,r=h.right>d.width,i=h.left<0,l?(o.style.overflowY="hidden",o.style.height="auto",e&&(u=h.top-(h.bottom-d.height),o.style.top=u+"px"),s&&(t=h.bottom+Math.abs(h.top),o.style.bottom=t+"px")):(o.style.top=0,o.style.height=d.height+"px",o.style.overflowY="scroll"),n?(o.style.overflowX="hidden",o.style.width="auto",r&&(a=h.left-(h.right-d.width),o.style.left=a+"px"),i?(c=h.right+Math.abs(h.left),o.style.right=c+"px"):void 0):(o.style.left=0,o.style.width=d.width+"px",o.style.overflowX="scroll")},100),!1},t.prototype.hide=function(){if(this.isVisible())return document.body.removeChild(this.element)},t.prototype.isVisible=function(){return null!=this.element.parentNode},t.prototype.getTargetPasteCell=function(){return this.table.activeCells.sort(this.sortFunc)[0]},t.prototype.sortFunc=function(t,e){return t.address[0]-e.address[0]},t.prototype.getUpperLeftPasteCell=function(){var t,e,i,o,r,s,n;for(s=(e=this.table.activeCells)[0],o=0,r=e.length;o<r;o++)n=(t=e[o]).address[0],i=t.address[1],n<s.address[0]?s=t:n===s.address[0]&&i<s.address[1]&&(s=t);return s},t.prototype.displayBorders=function(){if(this.table.copiedGridChange)return this.table.copiedGridChange.displayBorders()},t.prototype.hideBorders=function(){if(this.table.copiedGridChange)return this.table.copiedGridChange.removeBorders()},t.prototype.cut=function(t,e){var i,o;return(o=e.contextMenu).hideBorders(),e.copiedGridChange=new GridEdit.GridChange(e.activeCells),(i=new GridEdit.GridChange(e.activeCells,"ge-blank")).apply(!1,!1),e.addToStack({type:"cut",grid:i}),o.displayBorders(),o.hide()},t.prototype.copy=function(t,e){var i;return i=e.contextMenu,e.copiedGridChange=new GridEdit.GridChange(e.activeCells),i.displayBorders(),i.hide()},t.prototype.paste=function(t,e){var i,o,r,s,n,l,a;if((s=e.contextMenu).hide(),i=s.getUpperLeftPasteCell(),o=e.copiedGridChange,i.editable&&o)return(n=new GridEdit.GridChange(e.activeCells)).copyValues(),r=o.applyTo(n),l=i.address[0],a=i.address[1],"pasteGrid"===r?e.addToStack({type:"paste-pasteGrid",grid:o,pasteGrid:n,x:l,y:a}):e.addToStack({type:"paste-copyGrid",grid:o,x:l,y:a})},t.prototype.fill=function(t,e){var i,o,r,s;return s=e.contextMenu,i=s.getUpperLeftPasteCell(),o=i.value(),(r=new GridEdit.GridChange(e.activeCells,o)).apply(!1,!1),e.addToStack({type:"fill",grid:r}),s.hide()},t.prototype.selectAll=function(t,e){return e.clearActiveCells(),setTimeout(function(){var t,i,o,r,s;for(r=[],t=0,i=(o=e.rows).length;t<i;t++)s=o[t],r.push(s.select());return r},100)},t.prototype.insertBelow=function(t,e){return e.insertBelow()},t.prototype.insertAbove=function(t,e){return e.insertAbove()},t.prototype.removeRow=function(t,e){var i,o,r,s;for(s={},i=0,o=(r=new GridEdit.GridChange(e.activeCells).cells).length;i<o;i++)s[r[i].address[0]]=!0;return e.removeRows(Object.keys(s))},t.prototype.undo=function(t,e){return e.undo()},t.prototype.redo=function(t,e){return e.redo()},t.prototype.toggle=function(t){var e;return(e=this.actionNodes[t].classList).toggle("enabled"),e.toggle("disabled")},t.prototype.execute=function(t,e){var i;if(this.table.openCell&&this.table.openCell.hideControl(),GridEdit.Hook.prototype.run(this,"beforeContextMenuAction",e,this.table))return t(e,this.table),i=this.table,setTimeout(function(){if(i.useFixedHeaders)return GridEdit.Utilities.prototype.fixHeaders(i)},100),GridEdit.Hook.prototype.run(this,"afterContextMenuAction",e,this.table)},t.prototype.events=function(t){return this.element.onclick=function(e){var i;return i=e.target.getAttribute("name"),t.execute(t.actionCallbacks.byName[i],e)}},t}()}.call(this),function(){GridEdit.Utilities=function(){function t(){}return t.prototype.setAttributes=function(t,e){var i,o,r;o=[];for(i in e)(r=e[i])?o.push(t.setAttribute(i,r)):o.push(void 0);return o},t.prototype.setStyles=function(t,e){var i,o,r;o=[];for(i in e)r=e[i],o.push(t.style[i]=r+"px");return o},t.prototype.clearActiveCells=function(t){var e,i,o,r,s,n,l,a,h;if(h=t.redCells,i=t.activeCells,t.openCell&&t.openCell.edit(t.openCell.control.value),h.length>0){for(r=o=0,n=h.length;o<n;r=++o)null!=(a=h[r])&&a.makeInactive();t.redCells=[]}if(i.length>0){for(r=s=0,l=i.length;s<l;r=++s)null!=(e=i[r])&&e.makeInactive(),null!=e&&e.hideControl();t.activeCells=[]}if(t.selectionStart=null,t.selectionEnd=null,t.contextMenu.hide(),t.selectedCol)return t.selectedCol.makeInactive()},t.prototype.capitalize=function(t){return t.toLowerCase().replace(/\b./g,function(t){return t.toUpperCase()})},t.prototype.valueFromKey=function(t,e){var i;return i=String.fromCharCode(t),e?i:i.toLowerCase()},t.prototype.getScreenDimensions=function(){var t,e,i,o,r,s;return o=window,t=document,e=t.documentElement,i=t.getElementsByTagName("body")[0],r=o.innerWidth||e.clientWidth||i.clientWidth,s=o.innerHeight||e.clientHeight||i.clientHeight,{width:r,height:s}},t.prototype.repositionFixedHeader=function(t){var e,i,o,r,s,n;if((s=t.fixedHeader)&&(r=s.table))return o=document.documentElement,n=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),e=t.thead,i=e.getBoundingClientRect(),r.style.left=i.left+n+"px"},t.prototype.fixHeaders=function(t){return clearTimeout(this.fixHeadersBuffer),this.fixHeadersBuffer=setTimeout(function(){var e,i,o,r,s,n,l,a,h,c,d,u,p,f,y,b,v,m,C,w,g,x,k,R,E,A,G;for(m=t.config.includeRowHandles?1:0,l=(o=t.thead).getElementsByTagName("th"),t.fixedHeader?((A=t.fixedHeader.table)&&A.parentNode&&t.fixedHeader.table.parentNode.removeChild(A),e=t.fixedHeader.backgroundColor):"rgba(0, 0, 0, 0)"!==(e=window.getComputedStyle(o).backgroundColor)&&"transparent"!==e||(e="white"),a=document.documentElement,x=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),k=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),f=(p=t.element).scrollLeft||0,y=p.scrollTop||0,r=o.getBoundingClientRect(),(u=document.createElement("table")).className=t.tableEl.className+" ge-fixed-table-header",u.style.position="absolute",u.style.top=r.top+k+y+"px",u.style.left=r.left+x+f+"px",u.style.width=r.width+"px",u.style.zIndex=1039,u.style.pointerEvents="none",(c=document.createElement("thead")).className=o.className,c.ondragenter=o.ondragenter,c.ondragleave=o.ondragleave,d=document.createElement("tr"),w=0,v=b=0,g=l.length;b<g;v=++b){if(s=l[v],n=s.getBoundingClientRect(),h=document.createElement("th"),h.innerHTML=s.innerHTML,h.className=s.className,h.style.position="absolute",h.style.minWidth=n.width+"px",h.style.maxWidth=n.width+"px",h.style.width=n.width+"px",h.style.minHeight=n.height+"px",h.style.maxHeight=n.height+"px",h.style.left=w+"px",h.style.backgroundColor=e,h.setAttribute("col-id",v-m),h.onclick=function(e){var i,o;return o=this.getAttribute("col-id"),i=t.cols[o],GridEdit.Utilities.prototype.clearActiveCells(t),setTimeout(function(){var t,e,o,r,s;for(i.makeActive(),s=[],e=0,o=(r=i.cells).length;e<o;e++)t=r[e],s.push(t.addToSelection());return s},0)},i=t.cols[v-m])if(i.headerStyle){R=i.headerStyle;for(C in R)G=R[C],h.style[C]=G}else{E=i.style;for(C in E)G=E[C],h.style[C]=G}w+=n.width,d.appendChild(h)}return c.appendChild(d),u.appendChild(c),document.body.appendChild(u),t.fixedHeader={table:u,backgroundColor:e}},100)},t}()}.call(this),function(){GridEdit.Column=function(){function t(t,e){var i,o,r,s;this.attributes=t,this.table=e,this.id=this.index=this.table.cols.length,this.defaultValue=this.attributes.defaultValue,this.cellClass=this.attributes.cellClass,this.cells=[],i=this.attributes.format,this.format=function(t){return i?i(t):t},r=this.attributes;for(o in r)s=r[o],this[o]=s;this.attributes.label&&(this.element=document.createElement("th"),this.textNode=document.createTextNode(this.attributes.label),this.element.appendChild(this.textNode),this.applyStyle(),this.events()),delete this.attributes}return t.prototype.applyStyle=function(){var t,e,i;if(this.headerStyle){t=[];for(i in this.headerStyle)t.push(this.element.style[i]=this.headerStyle[i]);return t}e=[];for(i in this.style)e.push(this.element.style[i]=this.style[i]);return e},t.prototype.next=function(){return this.table.cols[this.index+1]},t.prototype.previous=function(){return this.table.cols[this.index-1]},t.prototype.makeActive=function(){return this.element.classList.add("active"),this.table.selectedCol=this},t.prototype.makeInactive=function(){return this.element.classList.remove("active"),this.table.selectedCol=null},t.prototype.events=function(){var t,e;return t=this,e=t.table,this.element.onclick=function(i){var o,r,s,n,l;for(GridEdit.Utilities.prototype.clearActiveCells(e),t.makeActive(),l=[],r=0,s=(n=t.cells).length;r<s;r++)o=n[r],l.push(o.addToSelection());return l},this.element.onmousedown=function(i){if(3!==i.which)return!1;e.contextMenu.show(i.x,i.y,t.cells[0])}},t}()}.call(this),function(){var t=function(t,i){function o(){this.constructor=t}for(var r in i)e.call(i,r)&&(t[r]=i[r]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t},e={}.hasOwnProperty;GridEdit.Row=function(){function t(t,e){var i,o;this.attributes=t,this.table=e,this.source=this.attributes,this.id=this.table.rows.length,this.cells=[],this.index=this.table.rows.length,this.element=document.createElement("tr"),this.cssClass=this.attributes.cssClass,this.cssClass&&(this.element.className=this.cssClass),this.oldBorderBottom=this.element.style.borderBottom,this.oldBorderTop=this.element.style.borderTop,this.type=this.attributes.gridEditRowType,this.alwaysPristine=!1,o=this.table,i=this,this.element.ondragenter=function(t){var e;return o.lastDragOverIsBeforeFirstRow=!1,(e=o.lastDragOver)?0!==i.index&&e.index===i.index||(e.element.style.borderBottom=i.oldBorderBottom,i.element.style.borderBottom=o.theme.borders.dragBorderStyle):i.element.style.borderBottom=o.theme.borders.dragBorderStyle,o.lastDragOver=i},this.includeRowHandles=this.table.config.includeRowHandles,GridEdit.Utilities.prototype.setAttributes(this.element,{id:"row-"+this.id})}return t.prototype.createCell=function(t){var e,i,o;switch(o=this.cells.length,i=this.table.cols[o],i.type){case"string":e=new GridEdit.StringCell(t,this);break;case"number":e=new GridEdit.NumberCell(t,this);break;case"date":e=new GridEdit.DateCell(t,this);break;case"html":e=new GridEdit.HTMLCell(t,this);break;case"select":e=new GridEdit.SelectCell(t,this);break;case"textarea":e=new GridEdit.TextAreaCell(t,this);break;case"checkbox":e=new GridEdit.CheckBoxCell(t,this);break;default:e=new GridEdit.GenericCell(t,this)}return e},t.prototype.below=function(){return this.table.rows[this.index+1]},t.prototype.above=function(){return this.table.rows[this.index-1]},t.prototype.select=function(){var t,e,i,o,r;for(r=[],e=0,i=(o=this.cells).length;e<i;e++)t=o[e],r.push(t.addToSelection());return r},t.prototype.afterEdit=function(){return this.table.calculateSubtotals()},t.prototype.addHandle=function(){var t;if(this.includeRowHandles)return t=new GridEdit.HandleCell(this),this.element.appendChild(t.element)},t}(),GridEdit.GenericRow=function(e){function i(t,e){var o,r,s,n,l,a;for(this.attributes=t,this.table=e,i.__super__.constructor.apply(this,arguments),this.editable=!0,this.addHandle(),s=n=0,l=(a=this.table.cols).length;n<l;s=++n)r=a[s],o=this.createCell(this.attributes[r.valueKey]),this.cells.push(o),this.table.cols[s].cells.push(o),this.element.appendChild(o.element);delete this.attributes}return t(i,e),i}(GridEdit.Row),GridEdit.StaticRow=function(e){function i(t,e){this.attributes=t,this.table=e,i.__super__.constructor.apply(this,arguments),this.addHandle(),this.editable=this.attributes.editable=!1,this.element.innerHTML=this.attributes.html,this.type="static",delete this.attributes}return t(i,e),i}(GridEdit.Row),GridEdit.SubTotalRow=function(e){function i(t,e){var o,r,s,n,l,a,h;for(this.attributes=t,this.table=e,i.__super__.constructor.apply(this,arguments),this.subtotalColumns={},this.labels=this.attributes.labels,this.running=this.attributes.running,this.alwaysPristine=!0,this.addHandle(),s=n=0,l=(a=this.table.cols).length;n<l;s=++n)r=a[s],(o=new GridEdit.GenericCell("",this)).editable=!1,this.labels&&(h=this.labels[r.valueKey],o.element.innerHTML=h||""),this.cells.push(o),this.table.cols[s].cells.push(o),this.element.appendChild(o.element),this.attributes.subtotal[r.valueKey]&&(this.subtotalColumns[r.valueKey]=s);this.table.subtotalRows.push(this),this.calculate()}return t(i,e),i.prototype.calculate=function(){var t,e,i,o,r,s,n,l,a,h,c,d,u,p,f;if(p=-1,!this.running)for(o=0,s=(l=this.table.subtotalRows).length;o<s;o++)(u=l[o].index)<this.index&&u>p&&(p=u);a=this.subtotalColumns,c=[];for(e in a){for(i=a[e],f=0,r=0,n=(h=this.table.rows).length;r<n;r++)if((d=h[r]).index>p){if(d.index===this.index)break;"subtotal"!==d.type&&"header"!==d.type&&(t=d.cells[i])&&(f+=Number(t.value()))}c.push(this.cells[i].value(f,!1))}return c},i.prototype.afterEdit=function(){},i}(GridEdit.Row),GridEdit.HeaderRow=function(e){function i(t,e){var o,r,s,n,l,a;for(this.attributes=t,this.table=e,i.__super__.constructor.apply(this,arguments),this.editable=!0,this.addHandle(),s=n=0,l=(a=this.table.cols).length;n<l;s=++n)r=a[s],(o=new GridEdit.HTMLCell(this.attributes[r.valueKey],this)).editable=!0,this.cells.push(o),this.table.cols[s].cells.push(o),this.element.appendChild(o.element);delete this.attributes}return t(i,e),i}(GridEdit.Row)}.call(this),function(){var t=function(t,i){function o(){this.constructor=t}for(var r in i)e.call(i,r)&&(t[r]=i[r]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t},e={}.hasOwnProperty;GridEdit.Cell=function(){function t(t,e){this.originalValue=t,this.row=e,this.index=this.row.cells.length,this.id=this.row.id+"-"+this.index,this.address=[this.row.id,this.index],this.table=this.row.table,this.col=this.table.cols[this.index],this.meta=this.col,this.element=document.createElement("td")}return t.prototype.initialize=function(){return this.initEditable(),this.initValueKey(),this.initSource(),this.initOriginalValue(),this.initSourceValue(),this.initNode(),this.initControl(),this.applyControlBehavior(),this.applyEventBehavior(),GridEdit.Hook.prototype.initCellHooks(this),this.applyStyle()},t.prototype.initOriginalValue=function(){if(void 0===this.originalValue)return this.originalValue=""},t.prototype.initSourceValue=function(){return this.source[this.valueKey]=this.originalValue},t.prototype.initEditable=function(){if(this.editable=!1!==this.col.editable,this.editable)return this.element.classList.add("editable")},t.prototype.initValueKey=function(){return this.valueKey=this.col.valueKey},t.prototype.initSource=function(){return this.source=this.table.config.rows[this.address[0]]},t.prototype.initControl=function(){return this.control=document.createElement("input")},t.prototype.initNode=function(){if(this.element.appendChild(document.createTextNode(this.col.format(this.originalValue))),(this.placeholder||this.col.placeholder)&&!this.originalValue)return this.renderPlaceholder()},t.prototype.renderPlaceholder=function(){return this.originalColor=this.element.style.color,this.element.style.color="#ccc",this.element.textContent=this.placeholder||this.col.placeholder},t.prototype.showRed=function(){return this.showUneditable()},t.prototype.applyStyle=function(){var t,e;if(this.col.cellClass&&this.element.classList.add(this.col.cellClass),this.col.style){t=[];for(e in this.col.style)t.push(this.element.style[e]=this.col.style[e]);return t}},t.prototype.addToSelection=function(){return this.showActive(),this.table.activeCells.push(this)},t.prototype.removeFromSelection=function(){var t;return t=this.table.activeCells.indexOf(this),this.table.activeCells.splice(t,1),this.showInactive()},t.prototype.isActive=function(){return-1!==this.table.activeCells.indexOf(this)},t.prototype.makeActive=function(t){var e;if(null==t&&(t=!0),this.table.hideControl(),t&&GridEdit.Utilities.prototype.clearActiveCells(this.table),!this.isActive()&&GridEdit.Hook.prototype.run(this,"beforeActivate",this))return this.showActive(),this.table.activeCells.push(this),this.table.selectionStart=this,(e=this.table.openCell)&&e.edit(e.control.value),GridEdit.Hook.prototype.run(this,"afterActivate",this)},t.prototype.makeInactive=function(){return this.showInactive()},t.prototype.showActive=function(){if(!this.isActive())return this.oldBackgroundColor=this.element.style.backgroundColor,this.element.style.backgroundColor=this.table.theme.cells.activeColor},t.prototype.showInactive=function(){return this.element.style.backgroundColor=this.oldBackgroundColor||""},t.prototype.showUneditable=function(){var t;return this.element.style.backgroundColor=this.table.theme.cells.uneditableColor,this.table.mobile?(t=this,setTimeout(function(){return t.makeInactive()},1e3)):this.table.redCells.push(this)},t.prototype.edit=function(t){return null==t&&(t=null),this.editable?null===t?this.showControl():(this.value(t),this.isBeingEdited()?this.hideControl():void 0):this.showUneditable()},t.prototype.value=function(t,e){var i,o;return null==t&&(t=null),null==e&&(e=!0),i=this.source[this.valueKey],null!==t&&t!==i?(t=this.formatValue(t),o=this.value(),GridEdit.Hook.prototype.run(this,"beforeEdit",this,o,t)?(e&&this.table.addToStack({type:"cell-edit",oldValue:o,newValue:t,address:this.address}),this.setValue(t),this.renderValue(t),this.row.afterEdit(),this.table.useFixedHeaders&&GridEdit.Utilities.prototype.fixHeaders(this.table),GridEdit.Hook.prototype.run(this,"afterEdit",this,o,t,this.table.contextMenu.getUpperLeftPasteCell()),this.table.checkIfCellIsDirty(this),t):i):i},t.prototype.formatValue=function(t){return t},t.prototype.setValue=function(t){return this.source[this.valueKey]=t},t.prototype.select=function(){return this.control.select()},t.prototype.renderValue=function(t){return(this.placeholder||this.col.placeholder)&&""===t?this.renderPlaceholder():(this.element.style.color=this.originalColor||"",this.element.textContent=this.col.format(t))},t.prototype.isDirty=function(){return!this.row.alwaysPristine&&this.originalValue!==this.value()},t.prototype.focus=function(){var t;return this.table.mobile?this.control.focus():(t=this.control,setTimeout(function(){var e,i;return t.focus(),e=0,t.value&&(e=t.value.length),t.setSelectionRange?t.setSelectionRange(e,e):t.createTextRange?((i=t.createTextRange()).collapse(!0),i.moveEnd("character",e),i.moveStart("character",e),i.select()):void 0},0))},t.prototype.showControl=function(t){return null==t&&(t=null),this.editable?GridEdit.Hook.prototype.run(this,"beforeControlInit",this)?(this.table.contextMenu.hideBorders(),this.renderControl(),this.setControlValue(t),this.table.openCell=this,this.focus(),GridEdit.Hook.prototype.run(this,"afterControlInit",this)):void 0:this.showUneditable()},t.prototype.setControlValue=function(t){return this.control.value=t},t.prototype.renderControl=function(){var t;return t=this.position(),GridEdit.Utilities.prototype.setStyles(this.control,{width:t.width,height:t.height}),this.element.appendChild(this.control),this.element.style.backgroundColor="white"},t.prototype.hideControl=function(){if(GridEdit.Hook.prototype.run(this,"beforeControlHide",this))return this.isBeingEdited()&&this.control.parentNode.removeChild(this.control),this.table.openCell=null,GridEdit.Hook.prototype.run(this,"afterControlHide",this)},t.prototype.applyControlBehavior=function(){var t;return t=this,this.table,this.control.onkeydown=function(e){switch(e.which){case 13:case 9:return t.edit(this.value)}}},t.prototype.position=function(){var t;return t=this.element.getBoundingClientRect(),{top:this.element.offsetTop,bottom:this.element.offsetTop+t.height,left:this.element.offsetLeft,right:this.element.offsetLeft+t.width,width:t.width,height:t.height}},t.prototype.reposition=function(){if(!this.table.mobile)return GridEdit.Utilities.prototype.setStyles(this.control,this.position())},t.prototype.next=function(){var t;return this.row.cells[this.index+1]||(null!=(t=this.row.below())?t.cells[0]:void 0)},t.prototype.previous=function(){var t;return this.row.cells[this.index-1]||(null!=(t=this.row.above())?t.cells[this.row.cells.length-1]:void 0)},t.prototype.above=function(){var t;return null!=(t=this.row.above())?t.cells[this.index]:void 0},t.prototype.below=function(){var t;return null!=(t=this.row.below())?t.cells[this.index]:void 0},t.prototype.isBefore=function(t){return t.address[0]===this.address[0]&&t.address[1]>this.address[1]},t.prototype.isAfter=function(t){return t.address[0]===this.address[0]&&t.address[1]<this.address[1]},t.prototype.isAbove=function(t){return t.address[0]>this.address[0]&&t.address[1]===this.address[1]},t.prototype.isBelow=function(t){return t.address[0]<this.address[0]&&t.address[1]===this.address[1]},t.prototype.addClass=function(t){return this.element.classList.add(t)},t.prototype.removeClass=function(t){return this.element.classList.remove(t)},t.prototype.isBeingEdited=function(){return!!this.control&&null!=this.control.parentNode},t.prototype.toggleActive=function(){return this.isActive()?this.removeFromSelection():this.makeActive(!1)},t.prototype.isVisible=function(){var t;return(t=this.position()).top>=this.table.topOffset&&t.bottom<=window.innerHeight},t.prototype.onReturnKeyPress=function(){return this.table.moveTo(this.table.belowCell())},t.prototype.onSpaceKeyPress=function(){return this.edit()},t.prototype.onKeyPress=function(t){return this.showControl(t)},t.prototype.applyEventBehavior=function(){var t,e,i,o;return t=this,o=this.table,e=null,this.element.onfocus=function(e){return t.reposition()},o.mobile?(i=null,this.element.ontouchstart=function(t){if(i=t.changedTouches[0].clientY,GridEdit.Utilities.prototype.clearActiveCells(o),o.openCell)return o.openCell.hideControl()},this.element.ontouchend=function(e){var o;if(o=e.changedTouches[0].clientY,e.changedTouches.length<2&&Math.abs(o-i)<3)return e.preventDefault(),t.edit()}):(this.element.onclick=function(i){var r,s,n,l,a,h,c,d,u,p,f,y,b,v,m,C,w,g,x,k,R,E,A;if(o.contextMenu.hideBorders(),o.lastClickCell===t)GridEdit.Hook.prototype.run(t,"onDblClick",t,i)&&(o.lastClickCell=null,t.showControl(t.value()));else if(o.lastClickCell=t,clearInterval(e),e=setTimeout(function(){return o.lastClickCell=null},1e3),GridEdit.Hook.prototype.run(t,"onClick",t,i)){if(u=i.ctrlKey,c=i.metaKey,A=i.shiftKey,r=function(t){},n<=a)for(d=p=v=n,m=a;v<=m?p<=m:p>=m;d=v<=m?++p:--p)o.getCell(E,d).makeActive(!1);else for(d=f=C=a,w=n;C<=w?f<=w:f>=w;d=C<=w?++f:--f)o.getCell(E,d).makeActive(!1);if((u||c)&&t.toggleActive(),A)if(s=o.activeCells[0],l=s.address[0],n=s.address[1],h=t.address[0],a=t.address[1],l<=h)for(E=y=g=l,x=h;g<=x?y<=x:y>=x;E=g<=x?++y:--y)r(E);else for(E=b=k=h,R=l;k<=R?b<=R:b>=R;E=k<=R?++b:--b)r(E)}return!1},this.element.onmousedown=function(e){if(3!==e.which)return e.shiftKey||e.ctrlKey||e.metaKey||(o.state="selecting",t.makeActive()),!1;o.contextMenu.show(e.clientX,e.clientY,t)},this.element.onmouseover=function(e){if("selecting"===o.state)return o.selectionEnd=t,o.setSelection()},this.element.onmouseup=function(e){if(3!==e.which&&(o.selectionEnd=t,o.state="ready",!e.metaKey&&!e.ctrlKey))return o.setSelection()})},t}(),GridEdit.StringCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="string",this.initialize()}return t(i,e),i}(GridEdit.Cell),GridEdit.NumberCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="number",this.initialize()}return t(i,e),i.prototype.focus=function(){var t;return this.table.mobile?this.control.focus():(t=this.control,setTimeout(function(){return t.focus()},0))},i.prototype.initControl=function(){return this.control=document.createElement("input"),this.control.type="number"},i.prototype.normalizeValue=function(t){var e;return null===t||void 0===t||""===t?null:(e=Number(t),isNaN(e)?null:e)},i.prototype.formatValue=function(t){return this.normalizeValue(t)},i.prototype.setValue=function(t){return this.source[this.valueKey]=this.normalizeValue(t)},i}(GridEdit.Cell),GridEdit.CheckBoxCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="checkbox",this.initialize()}return t(i,e),i.prototype.initialize=function(){return this.initEditable(),this.initValueKey(),this.initSource(),this.initOriginalValue(),this.initSourceValue(),this.applyEventBehavior(),GridEdit.Hook.prototype.initCellHooks(this),this.applyStyle(),this.initNode(),this.toggleable=this.editable,this.editable=!1,this.renderValue()},i.prototype.initNode=function(){var t;return t=document.createElement("div"),t.style.width="1em",t.style.margin="auto",this.span=document.createElement("span"),t.appendChild(this.span),this.element.appendChild(t)},i.prototype.edit=function(){return!1},i.prototype.initControl=function(){return this.toggle()},i.prototype.renderControl=function(){return GridEdit.Utilities.prototype.clearActiveCells(this.table)},i.prototype.isBeingEdited=function(){return!1},i.prototype.toggle=function(){return this.toggleable?(this.value(!this.value()),this.setValue(this.value())):this.showUneditable()},i.prototype.renderValue=function(){var t;return t=this.toggleable?"":"disabled",this.value()?this.table.theme.inputs.checkbox.checkedClassName?this.span.className=this.table.theme.inputs.checkbox.checkedClassName:this.span.innerHTML="<input type='checkbox' "+t+" checked />":this.table.theme.inputs.checkbox.uncheckedClassName?this.span.className=this.table.theme.inputs.checkbox.uncheckedClassName:this.span.innerHTML="<input type='checkbox' "+t+" />"},i.prototype.applyEventBehavior=function(){var t;return i.__super__.applyEventBehavior.apply(this,arguments),t=this,this.element.onclick=function(e){return t.table.contextMenu.hideBorders(),t.toggle()}},i.prototype.onSpaceKeyPress=function(){return this.toggle()},i}(GridEdit.Cell),GridEdit.DateCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="date",this.initialize()}return t(i,e),i.prototype.initNode=function(){return this.element.appendChild(document.createTextNode(this.toDateString(this.originalValue)))},i.prototype.initControl=function(){this.control=this.toDate();try{if(this.originalValue)return this.control.valueAsDate=new Date(this.originalValue)}catch(t){return t,this.control.value=this.toDateString(new Date(this.originalValue))}},i.prototype.formatValue=function(t){if(t.length>0)return this.toDateString(Date.parse(t));if(t instanceof Date)return this.toDateString(t);if(0===t.length){try{this.control.valueAsDate=null}catch(t){t,this.control.value=""}return""}},i.prototype.setValue=function(t){return this.source[this.valueKey]=this.toDateObject(t),this.setControlValue()},i.prototype.setControlValue=function(){try{return this.control.valueAsDate=this.source[this.valueKey]}catch(t){return t,this.control.value=this.source[this.valueKey]}},i.prototype.renderValue=function(){return this.element.textContent=this.col.format(this.toDateString(this.value()))},i.prototype.toDateObject=function(t){var e;return null==t&&(t=null),t&&""!==t?(e=t.split("-"),new Date(e[2],e[0]-1,e[1])):null},i.prototype.toDateString=function(t){var e;return null==t&&(t=null),(e=t&&""!==t?new Date(t):this.value()?new Date(this.value()):null)instanceof Date?isNaN(e.getTime())?"":("0"+(e.getUTCMonth()+1)).slice(-2)+"-"+("0"+e.getUTCDate()).slice(-2)+"-"+e.getUTCFullYear():""},i.prototype.toDate=function(){var t;return t=document.createElement("input"),t.type="text",t.value=this.toDateString(),t},i.prototype.toDateInputString=function(t){var e;return null==t&&(t=null),t&&""!==t?e=new Date(t):this.value()&&(e=new Date(this.value())),e instanceof Date?e.getUTCFullYear()+"-"+("0"+(e.getUTCMonth()+1)).slice(-2)+"-"+("0"+e.getUTCDate()).slice(-2):""},i}(GridEdit.Cell),GridEdit.HTMLCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="html",this.initialize()}return t(i,e),i.prototype.initNode=function(){return this.htmlContent=this.col.defaultValue||this.originalValue||"",this.element.appendChild(this.toFragment())},i.prototype.setValue=function(t){var e;return this.htmlContent=t,e=this.toFragment(),this.element.innerHTML="",this.element.appendChild(e)},i.prototype.toFragment=function(){var t,e;return t=document.createElement("div"),e=document.createDocumentFragment(),t.innerHTML=this.htmlContent,e.appendChild(t.firstChild||document.createTextNode("")),e},i.prototype.renderValue=function(){return this.htmlContent},i}(GridEdit.Cell),GridEdit.SelectCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="select",this.initialize()}return t(i,e),i.prototype.initNode=function(){var t;return t=document.createTextNode(this.originalValue),this.element.appendChild(t)},i.prototype.setControlValue=function(){var t,e,i,o,r,s,n,l,a,h,c;for(t=this,this.control.innerHTML="",h=[],o=0,s=(a=this.meta.choices).length;o<s;o++){if(e=a[o],l=document.createElement("option"),e instanceof Array)for(i=r=0,n=e.length;r<n;i=++r)c=e[i],0===i&&(l.value=c),1===i&&(l.text=c);else l.value=l.text=e;t.value()===e&&(l.selected=!0),h.push(this.control.add(l))}return h},i.prototype.initControl=function(){var t,e;return t=this,e=document.createElement("select"),this.control=e,this.meta.choices||console.log("There is not a 'choices' key in cell "+this.address+" and you specified that it was of type 'select'"),this.setControlValue(),e.classList.add(this.table.theme.inputs.select.className),e.onchange=function(e){return t.edit(e.target.value)}},i.prototype.select=function(){return!1},i.prototype.onSpaceKeyPress=function(){var t;return this.renderControl(),t=this.control,setTimeout(function(){var e;return(e=document.createEvent("MouseEvents")).initMouseEvent("mousedown",!0,!0,window),t.dispatchEvent(e)},0)},i.prototype.onKeyPress=function(t){var e,i,o,r,s,n,l,a;for(this.onSpaceKeyPress(),a=new RegExp("^"+t,"i"),l=[],i=o=0,r=(n=(e=this.control).options).length;o<r;i=++o){if(s=n[i],a.test(s.value)){e.selectedIndex=i;break}l.push(void 0)}return l},i}(GridEdit.Cell),GridEdit.TextAreaCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="textarea",this.initialize()}return t(i,e),i.prototype.initControl=function(){var t;return this,(t=document.createElement("textarea")).classList.add(this.table.theme.inputs.textarea.className),this.control=t},i}(GridEdit.Cell),GridEdit.GenericCell=function(e){function i(t,e){this.row=e,i.__super__.constructor.apply(this,arguments),this.type="generic",this.initialize()}return t(i,e),i}(GridEdit.Cell),GridEdit.HandleCell=function(){return function(t){var e,i,o;this.row=t,i=this.row,o=i.table,this.element=document.createElement("td"),this.element.setAttribute("draggable",!0),this.element.className=o.theme.cells.handleClassName,(e=document.createElement("div")).innerHTML="<span></span><span></span><span></span>",this.element.appendChild(e),this.element.onclick=function(t){var e;return e=i.index,i.table.selectRow(t,e)},this.element.ondragstart=function(){var t,e,r,s,n;for(i.cells[0].addToSelection(),e=r=s=(t=new GridEdit.GridChange(o.activeCells)).lowRow,n=t.highRow;s<=n?r<=n:r>=n;e=s<=n?++r:--r)o.rows[e].select();return o.contextMenu.hideBorders(),o.draggingRow=t},this.element.ondragend=function(){var t,e,i,r,s;if(s=o.draggingRow.lowRow,r=o.draggingRow.highRow-o.draggingRow.lowRow+1,e=o.lastDragOver.index,i=0,0===e?o.lastDragOverIsBeforeFirstRow||0===s||i++:s>e&&i++,t=e+i,o.lastDragOver.element.style.borderBottom=o.lastDragOver.oldBorderBottom,o.lastDragOver.element.style.borderTop=o.lastDragOver.oldBorderTop,o.lastDragOver.element.style.borderTop=o.lastDragOver.oldBorderTop,o.lastDragOver=null,t!==s)return o.moveRows(s,t,r,!0)}}}()}.call(this),function(){GridEdit.GridChange=function(){function t(t,e){var i,o,r,s,n,l,a,h,c,d,u;for(this.cells=t,u="ge-blank"===e,this.changes=[],this.table=this.cells[0].col.table,this.borderStyle=this.table.theme.cells.selectionBorderStyle,this.highRow=0,this.highCol=0,s=0,l=(h=this.cells).length;s<l;s++)d={row:(o=h[s]).address[0],col:o.address[1],value:u?"":e||o.value()},this.firstCell?d.row<this.firstCell.row?this.firstCell=d:d.row===this.firstCell.row&&d.col<this.firstCell.col&&(this.firstCell=d):(this.firstCell=d,this.lowRow=d.row,this.lowCol=d.col),d.row>this.highRow&&(this.highRow=d.row),d.col>this.highCol&&(this.highCol=d.col),d.row<this.lowRow&&(this.lowRow=d.row),d.col<this.lowCol&&(this.lowCol=d.col),this.changes.push(d);for(n=0,a=(c=this.changes).length;n<a;n++)(r=c[n]).rowVector=r.row-this.firstCell.row,r.colVector=r.col-this.firstCell.col;i=(this.highCol-this.lowCol+1)*(this.highRow-this.lowRow+1),this.scattered=this.cells.length!==i}return t.prototype.applyTo=function(t){var e,i,o,r,s,n,l,a,h,c,d,u,p,f,y,b,v;if(i=this.changes[0].value,t.scattered)return t.fill(i),"pasteGrid";if(o=this.width(),e=this.height(),d=t.width(),c=t.height(),d<o||c<e)return b=t.firstCell.row,v=t.firstCell.col,this.apply(b,v),"copyGrid";for(y=parseInt(d/o),f=parseInt(c/e),b=t.firstCell.row,v=t.firstCell.col,n=a=0,u=f;0<=u?a<u:a>u;n=0<=u?++a:--a)for(r=b+n*e,l=h=0,p=y;0<=p?h<p:h>p;l=0<=p?++h:--h)s=v+l*o,this.apply(r,s);return"pasteGrid"},t.prototype.copyValues=function(){var t,e,i,o,r,s,n,l;for(n=this.firstCell.row,l=this.firstCell.col,s=[],i=0,o=(r=this.changes).length;i<o;i++)e=r[i],(t=this.table.getCell(n+e.rowVector,l+e.colVector))&&t.editable?s.push(e.oldValue=t.value()):s.push(void 0);return s},t.prototype.width=function(){return this.highCol-this.lowCol+1},t.prototype.height=function(){return this.highRow-this.lowRow+1},t.prototype.fill=function(t){var e,i,o,r,s,n,l,a;for(l=this.firstCell.row,a=this.firstCell.col,n=[],o=0,r=(s=this.changes).length;o<r;o++)i=s[o],(e=this.table.getCell(l+i.rowVector,a+i.colVector))&&e.editable?(i.oldValue=e.value(),n.push(e.value(t,!1))):n.push(i.oldValue="");return n},t.prototype.apply=function(t,e){var i,o,r,s,n,l;for(!1!==t&&!1!==e||(t=this.firstCell.row,e=this.firstCell.col),l=[],r=0,s=(n=this.changes).length;r<s;r++)o=n[r],(i=this.table.getCell(t+o.rowVector,e+o.colVector))&&i.editable?(o.oldValue=i.value(),l.push(i.value(o.value,!1))):l.push(o.oldValue="");return l},t.prototype.undo=function(t,e){var i,o,r,s,n,l;for(!1!==t&&!1!==e||(t=this.firstCell.row,e=this.firstCell.col),l=[],r=0,s=(n=this.changes).length;r<s;r++)o=n[r],(i=this.table.getCell(t+o.rowVector,e+o.colVector))&&i.editable?l.push(i.value(o.oldValue,!1)):l.push(void 0);return l},t.prototype.displayBorders=function(){var t,e,i,o,r;for(r=[],e=0,i=(o=this.cells).length;e<i;e++)t=o[e],r.push(this.addBorder(t));return r},t.prototype.removeBorders=function(){var t,e,i,o,r;for(r=[],e=0,i=(o=this.cells).length;e<i;e++)t=o[e],r.push(t.element.style.border="");return r},t.prototype.addBorder=function(t){var e,i;return i=t.address[0],e=t.address[1],this.scattered?t.element.style.border=this.borderStyle:(this.firstCell.row===this.highRow?(t.element.style.borderTop=this.borderStyle,t.element.style.borderBottom=this.borderStyle):i===this.lowRow?t.element.style.borderTop=this.borderStyle:i===this.highRow&&(t.element.style.borderBottom=this.borderStyle),this.firstCell.col===this.highCol?(t.element.style.borderRight=this.borderStyle,t.element.style.borderLeft=this.borderStyle):e===this.lowCol?t.element.style.borderLeft=this.borderStyle:e===this.highCol?t.element.style.borderRight=this.borderStyle:void 0)},t}()}.call(this),function(){GridEdit.Theme=function(){function t(t,e){switch(this.themeName=t,this.themeName){case"bootstrap":this.apply(this.bootstrap);break;default:this.themeName="default",this.apply(this.default)}e&&(this.themeName=this.themeName+"-custom",this.apply(e))}return t.prototype.apply=function(t){var e,i,o,r,s;r=this,e=function(t,i){var o,r,s;r=[];for(o in i)"object"==typeof(s=i[o])?(t[o]||(t[o]={}),r.push(e(t[o],s))):r.push(t[o]=s);return r},o=[];for(i in t)"object"==typeof(s=t[i])?(r[i]||(r[i]={}),o.push(e(r[i],s))):o.push(r[i]=s);return o},t.prototype.default={bootstrap:!1,cells:{activeColor:"#FFE16F",uneditableColor:"#FFBBB3",handleClassName:"handle",selectionBorderStyle:"2px dashed blue"},borders:{dragBorderStyle:"3px solid rgb(160, 195, 240)"},inputs:{textarea:{className:"grid-edit"},select:{className:"grid-edit"},checkbox:{checkedClassName:!1,uncheckedClassName:!1}}},t.prototype.bootstrap={bootstrap:!0,cells:{activeColor:"#FFE16F",uneditableColor:"#FFBBB3",handleClassName:"handle",selectionBorderStyle:"2px dashed blue"},borders:{dragBorderStyle:"3px solid rgb(160, 195, 240)"},inputs:{textarea:{className:"form-control"},select:{className:"form-control"},checkbox:{checkedClassName:"glyphicon glyphicon-check",uncheckedClassName:"glyphicon glyphicon-unchecked"}}},t}()}.call(this),function(){GridEdit.Hook=function(){function t(){}return t.prototype.run=function(t,e){var i,o,r,s,n;if(t[e]){for(o=[],r=s=0,n=arguments.length;s<n;r=++s)i=arguments[r],r<2||o.push(i);return!1!==t[e].apply(t,o)}return!0},t.prototype.initTableHooks=function(t){var e;return e=t.config,t.beforeMoveRow=e.beforeMoveRow,t.afterMoveRow=e.afterMoveRow,t.beforeMoveRows=e.beforeMoveRows,t.afterMoveRows=e.afterMoveRows,t.beforeAddRow=e.beforeAddRow,t.afterAddRow=e.afterAddRow,t.beforeAddRows=e.beforeAddRows,t.afterAddRows=e.afterAddRows,t.beforeRemoveRow=e.beforeRemoveRow,t.afterRemoveRow=e.afterRemoveRow,t.beforeRemoveRows=e.beforeRemoveRows,t.afterRemoveRows=e.afterRemoveRows,t.beforeInsertBelow=e.beforeInsertBelow,t.afterInsertBelow=e.afterInsertBelow,t.beforeInsertAbove=e.beforeInsertAbove,t.afterInsertAbove=e.afterInsertAbove},t.prototype.initContextMenuHooks=function(t){var e;return e=t.table.config,t.beforeContextMenuAction=e.beforeContextMenuAction,t.afterContextMenuAction=e.afterContextMenuAction},t.prototype.initCellHooks=function(t){var e;return e=t.table.config,t.beforeEdit=e.beforeEdit,t.afterEdit=e.afterEdit,t.beforeActivate=e.beforeCellActivate,t.afterActivate=e.afterCellActivate,t.beforeControlInit=e.beforeControlInit,t.afterControlInit=e.afterControlInit,t.beforeControlHide=e.beforeControlHide,t.afterControlHide=e.afterControlHide,t.beforeNavigateTo=e.beforeCellNavigateTo,t.onClick=e.onCellClick,t.onDblClick=e.onCellDblClick},t}()}.call(this);